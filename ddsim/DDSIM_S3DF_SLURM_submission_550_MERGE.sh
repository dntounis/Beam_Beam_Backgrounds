#!/bin/bash
#
#SBATCH --account=atlas:default
#SBATCH --partition=roma
#SBATCH --job-name=C3_550_PS1_ddsim_merge
#SBATCH --output=C3_550_PS1_ddsim_merge_%A_%a.out
#SBATCH --error=C3_550_PS1_ddsim_merge_%A_%a.err
#SBATCH --cpus-per-task=1
#SBATCH --mem-per-cpu=12g
# #SBATCH --ntasks-per-node=1
#SBATCH --time=0-0:20:00
#SBATCH --gpus 0
#SBATCH --array=0-99 # Adjust this based on the number of seeds, e.g. for 60 seeds should be 0-59
#SBATCH --mail-user=dntounis@slac.stanford.edu
#SBATCH --mail-type=ALL # Type of e-mail from slurm; other options are: Error, Info
# Define an array of seeds

# first batch of seeds - 60

#seeds=(646726 824897 685736 268021 893161 473632 570691 973731 172660 588225 834692 765514 387394 382466 893505 682500 107626 581802 223639 907367 168136 116898 878488 974354 429435 514355 595020 298860 318192 795000 516831 938118 219951 473269 620860 549738 201099 969835 328981 649096 600364 495079 860906 277515 883098 789080 208830 751176 826856 521374 446610 442571 977237 956193 638935 629828 946409 711382 838586 478805)

# second batch of seeds - 73

#seeds=(568241 361733 718355 670236 392403 523638 775506 619237 887397 796413 307313 932023 665869 180940 981910 992834 541986 635763 858530 361884 501895 527488 561072 982265 586359 982832 743694 330631 679469 558889 749209 573285 520380 994774 619288 307004 368504 910818 138965 443531 928724 947691 901624 393914 177378 321364 599380 739432 966089 815377 733980 797286 784389 807508 291957 140752 800660 736089 183876 409570 779944 544875 939767 428507 147203 734028 511643 671095 561651 774906 724329 631167 596798)

# third batch of seeds - 60
#seeds=(527875 733579 360177 286038 479728 750622 869004 616205 664707 132661 781198 426737 328457 144480 621961 768697 685339 419765 809804 564915 262728 985882 256863 353443 409948 725103 996117 115337 182286 909242 984689 999153 696557 949647 890767 228995 677476 584121 730711 321485 446871 447608 771760 190219 128353 536212 886981 711233 790240 577473 524857 886026 376225 440800 831544 541993 576716 106733 876089 754625)

# fourth batch of seeds - 73
#seeds=(340252 566577 438336 983321 362111 175226 711267 185912 312192 847048 400945 561096 271634 831467 711631 875591 203540 473757 226527 595212 917314 256322 434222 840790 656615 150344 255367 164750 713978 431949 804069 481013 901407 342973 476156 736050 469163 457657 934359 664781 428914 998147 265876 614237 897014 939699 367571 894524 133257 323854 984156 759221 779288 124405 474231 183930 232355 597546 426705 311767 919859 646517 471934 880243 142979 919932 659688 928661 455310 975581 506428 745883 539398)



# fifth batch of seeds - 60
#seeds=(543233 255362 745272 124228 178466 391491 876024 380205 370773 517053 980082 662577 688195 175647 797156 788058 802239 459452 857731 535191 238485 138304 216183 874361 235906 743511 807171 827157 257990 223619 358518 485829 733650 416562 543329 818735 837505 905049 769364 403121 334830 513552 516979 913210 461862 548043 887717 236678 853606 305987 228695 773685 796978 360070 269021 676525 176672 950108 879837 181031)

# sixth batch of seeds - 73
#seeds=(244071 636953 289454 495847 834671 113032 870633 623883 907927 164473 597389 380514 304820 230620 573234 164430 264875 704146 141286 934215 362495 639964 282266 577828 645852 185707 603035 316100 645406 724162 772547 858771 524391 265941 635469 167072 483279 927919 524816 669271 781868 489164 873464 290592 746483 844571 340143 112380 711649 585187 652505 837659 660424 845927 762492 594595 728215 803151 627905 504649 932226 788942 256147 246388 598156 388773 440869 578711 527412 602460 787109 890956 668180)

# seventh batch of seeds - 60
#seeds=(659940 219310 619870 648410 131674 416553 729242 916255 708462 812034 488285 534727 585006 595612 997261 217735 941729 452402 613908 287031 773981 256940 216941 900828 823041 805347 596115 411417 422461 481779 164710 666180 958893 742585 554699 971029 711974 710545 145443 664246 436364 378490 873629 748566 589223 592184 640537 957053 369471 506259 358480 879063 129910 683222 801003 818013 846771 502422 421922 961349)

# eighth batch of seeds - 73
#seeds=(867256 610255 670955 396180 120286 290881 732204 428677 811574 579737 481823 386899 441487 557029 934344 956228 965227 510112 370892 869885 426793 974600 167330 902383 654383 827387 548401 837057 303154 954181 183931 159477 727263 572848 919080 118134 769781 220937 288880 367518 797387 456022 716416 340901 763055 597126 673286 756202 209556 893739 508516 840899 164308 262834 145627 237410 833405 394247 792784 912333 261905 504455 510972 612810 662076 943232 932319 822243 262420 509696 879474 877767 398469)

# ninth batch of seeds - 60
#seeds=(456696 835314 871968 842634 613090 326431 792023 221632 775134 278521 516128 807455 680025 968443 718714 585419 176035 151725 955974 760430 508174 333532 255768 609476 844625 682921 250244 500955 852985 618295 733961 800480 778783 195324 766312 517750 392113 320841 695334 857711 403510 231898 675523 409650 519075 494702 666107 589158 240253 701603 154253 269897 791450 171098 961866 211793 782328 527901 725989 372641)

# tenth batch of seeds - 73
#seeds=(193713 839552 430155 588399 572186 794843 988463 899095 765788 261291 555460 877818 590732 998567 625329 248279 751079 445996 697101 338465 215801 738582 820708 578978 189967 701686 169124 844464 302620 762140 530305 518350 479392 184449 547476 417572 459609 281875 361287 392630 637374 295469 480178 885006 693693 334450 871574 252370 174526 363713 152849 532442 316297 326248 713727 902637 895684 828844 361622 585479 437029 798945 647351 961663 637163 361990 459510 541948 945675 679782 880389 678709 724389)

# eleventh batch of seeds - 100
#seeds=(786400 688816 386752 847443 450635 974879 762564 988439 423145 347376 771924 601351 765651 803262 926361 482831 868452 616699 703417 962140 377175 822148 860631 596944 527651 318599 327874 467470 977128 644461 635071 304775 475914 657969 442595 257575 862679 278034 697768 460966 682311 420272 399007 803435 866435 404440 637643 702564 596087 509258 272889 887562 803510 391205 322471 950604 383687 745132 555669 475933 411768 936944 294038 864333 318749 546978 424279 480087 304185 496654 388167 685685 281257 735117 667986 407436 839739 619727 872566 957535 853231 732921 499852 808378 888489 268250 793611 373353 391404 728668 400710 869252 740023 713407 532013 804807 456711 367967 406445 460149)

# twelvth batch of seeds - 100
#seeds=(469542 338817 563512 601567 326172 758680 505212 979681 571023 749237 533105 739835 492895 693814 999048 612711 742543 590598 546021 996466 915731 920568 935129 356431 814615 302985 904785 510743 726908 392614 642659 499544 803260 560618 313580 798941 814673 839296 659865 579704 561880 538852 724142 810824 433719 681917 779027 709381 430857 476925 667138 322196 679261 801599 653699 514232 894045 580785 676996 497284 974767 988859 950716 622808 852740 927322 939753 462710 460121 967420 337793 574170 646070 520737 662774 384611 451315 403916 791621 829458 802957 949089 406500 674882 627277 676761 551131 802158 387858 470424 570223 607362 757442 802810 905698 609754 474751 479795 762080 638067)

# 13th batch of seeds - 100
#seeds=(896194 558708 692059 490942 417284 563412 511200 583314 915985 715464 632054 647894 550195 861262 591921 662851 609305 532237 917908 853140 650136 693647 634885 416299 953439 681507 698622 725914 406478 712891 900612 423076 486351 696182 782851 727323 442727 917798 586144 780541 944295 891043 824140 821166 516447 853843 652031 546917 401163 731247 666177 917537 562006 914489 876974 715461 446617 973335 897189 971816 694890 508314 872728 803981 787235 429546 822762 558752 731664 661443 937325 819260 938811 571307 424641 503614 771965 807098 524896 664328 614119 450283 929548 507673 637929 799634 462076 905822 605930 923972 695764 759591 884816 694723 449613 888987 763143 986243 816670 954776)

# 14th batch of seeds - 100
#seeds=(870431 632723 518093 630698 917165 607578 998538 837620 953539 631412 525318 830564 881345 815197 851689 725762 825346 874779 916432 709586 829379 890553 541233 957986 658330 881166 729424 681836 874765 753761 616899 502637 571327 676982 805975 992400 511636 521853 666646 881024 730062 611346 711753 792756 818342 693005 748462 824070 995915 864383 712647 940477 607624 984139 873124 569731 608146 881621 872043 618750 771273 677622 564963 862747 654265 539462 996762 519054 539377 948620 508220 718371 944861 913875 967291 537456 772180 542329 930289 636882 727054 863491 975094 749145 841944 700910 716725 922410 892619 934448 992294 909271 805921 774575 526665 830791 752507 817094 732985 845199)


# 15th batch of seeds - 100
#seeds=(875704 958629 978413 993676 804241 765796 888496 637955 615821 552023 953630 806698 679962 604340 885070 985217 767142 910314 989598 723019 989971 795557 666287 694760 591472 642520 821615 883301 778224 838703 988920 605342 844823 842217 979597 620790 831783 909954 869417 914896 953400 859027 828029 965155 971481 709900 940530 824896 897395 794129 958186 585344 525372 966505 822947 594010 713944 665958 635801 643581 901996 981184 893373 539283 690962 543862 877001 612907 580298 644853 602042 767373 604617 887073 999076 911828 539204 837704 606835 914953 833791 780911 733352 590216 665442 963814 979534 576164 641865 905572 827353 502353 733473 724758 997204 563862 690376 897310 825649 973860)

# 16th batch of seeds - 100
#seeds=(879542 680677 901326 522226 605273 825434 952924 724606 806677 711198 600612 576554 833769 711431 635618 751372 895818 827808 993357 604907 739344 990036 786370 804075 745094 650382 746983 570545 956680 888678 657508 619227 902128 989967 576345 557269 623234 768662 937532 718658 650288 900056 984610 531239 663395 723522 911216 639466 815456 901985 837172 531584 808474 552721 704325 735093 911903 963719 797369 734027 603072 689970 637866 551780 953109 567532 807292 687291 654281 689613 722326 943400 869470 578158 625835 534447 842496 836059 741029 668970 683677 923931 716863 678270 579319 601782 737254 695572 986830 593265 983625 712652 924472 966149 889819 790706 887523 894995 661746 931395)


# 17th batch of seeds - 100
#seeds=(726229 911150 806545 698814 978705 921087 923989 685404 870250 708821 932344 762893 875580 714886 822958 990844 691216 795834 614567 652516 601532 984782 735360 977001 910971 725003 736024 854140 989875 913724 762894 740151 950923 965342 830211 827440 672344 842391 857118 657124 863565 795045 808041 955163 819090 839790 931349 942428 676038 693387 926961 728792 916773 887567 792415 615512 802073 759213 671317 980078 663711 753661 617491 987567 956959 829834 847168 951759 818613 746787 926748 805468 791631 939376 839916 726593 965006 918810 831050 895680 823230 771411 801462 889975 688891 835976 831909 805733 928650 750475 623039 830651 804653 777101 890957 879923 783421 627669 762888 962218)


# 18th batch of seeds - 100
#seeds=(663574 692101 974060 997263 820254 930536 722949 769942 768881 876813 798499 800899 788467 806366 817639 728731 915050 764548 609292 842739 729847 998414 909842 780786 888821 964337 943205 648320 869995 616939 776664 926393 819082 893710 619602 746820 709669 861542 993307 927938 828635 721954 620006 622876 853357 803703 751631 882316 733403 813384 812484 749216 790263 754560 693036 768572 854425 963568 636685 893413 702602 664266 802262 647505 833487 719179 901282 910043 925280 964633 688517 871383 882558 708310 819543 676483 665690 648479 655531 680583 708340 959233 857710 687919 621375 971814 841199 953497 900358 759044 965797 641380 919995 768179 619832 722166 731268 741756 741887 731349)


# 19th batch of seeds - 100
#seeds=(904488 767637 788921 761918 768448 603181 683317 661090 978842 894053 668979 968073 845110 600586 668628 875200 730339 822013 968460 763979 626926 886103 748526 976565 775590 915225 954575 760727 669844 813957 831700 722478 665877 856706 724707 831753 714683 641294 952970 976956 948271 768290 908193 765789 908481 757592 934444 814135 803706 850179 674955 809184 756117 826629 829744 938364 984684 842106 989145 713449 776840 826725 998170 783088 748909 605481 820559 955879 881922 781299 872000 974706 777505 735860 691570 960381 854052 905208 655483 801316 667167 643918 851521 757249 695031 806401 718342 898376 700865 673475 881200 963595 967124 875051 911325 939169 843546 710423 998698 864673)

# 20th batch of seeds - 100
#seeds=(987065 823418 902621 981223 740051 719926 985080 714745 941807 845565 761727 764241 935322 754784 785086 744947 768869 768831 710385 812117 879876 748127 987897 952656 932962 796376 976755 990085 921311 705655 768500 991399 836505 796496 703815 735298 800702 733578 763875 844720 724325 783916 919915 763047 753532 930263 703498 764132 897299 708356 944848 804153 910902 807888 761315 778354 888340 965310 795301 793731 894159 772240 996491 834221 970571 787530 949154 859163 742071 769273 901631 827167 724198 905446 930421 847030 954901 902148 896629 880322 851183 769030 810038 841636 776514 789140 953472 990266 751084 927532 979042 890081 846880 991717 735632 911196 862143 738247 822818 887218)


# 21st batch of seeds - 100
#seeds=(801856 988010 855254 882861 977276 778652 804411 861365 704592 700087 933319 740076 711866 883359 887160 774132 732116 944956 894722 712738 813333 932606 928508 970697 713923 716034 862580 818183 885640 775613 998679 922517 972386 972711 817188 809183 935828 961841 877905 753277 881699 810849 983163 995781 730389 725456 896395 948516 823992 987597 829787 929098 832565 709101 813297 825133 797110 741638 741710 757050 913159 992788 873776 718435 979032 999302 856241 963040 929973 876965 868154 892674 906299 862632 797530 893078 958808 946386 895150 776142 798476 932303 730989 921464 743825 704690 988342 914808 820625 960427 718438 864414 921728 730703 869541 776441 877935 859423 938781 992735)


# 22nd batch of seeds - 100
#seeds=(962183 970636 958995 858141 720204 930592 904369 942612 782194 730876 718719 855080 993966 715409 814959 894352 780450 952328 985165 974831 701582 752941 710775 858342 805288 874660 747899 788428 712210 871502 910357 779938 939240 785213 728854 781414 804244 885527 810116 902949 986434 906767 783592 848138 979193 812781 777224 951440 789048 762111 962463 974571 921851 835769 737882 760553 964100 980750 890701 700431 837997 935569 711591 706954 972887 894452 709734 773383 929281 795688 937378 873198 838846 958438 718910 815909 814516 947446 961990 952755 796335 997658 975790 922080 861254 854682 815218 767171 822839 970129 936027 952100 967090 953840 760348 769264 998992 864590 851883 882343)


# 23rd batch of seeds - 100
#seeds=(779657 737265 783461 735914 888126 970449 777197 965584 870458 864515 829972 892564 796302 772889 849549 720349 821703 717423 741284 723520 760767 959626 794764 931769 915190 908041 861163 808763 964482 769014 737182 791706 917242 909471 830743 876990 763130 962066 722952 806786 896893 817911 909492 732756 790923 891729 778722 974186 885804 787036 765181 928934 772563 934812 932161 877760 710320 867733 794798 774939 930355 769583 880672 938869 835684 825554 858364 864611 948887 936646 738820 822246 764529 725953 952210 771892 782743 768782 793649 837375 818531 765415 919669 846672 839653 944855 797333 851782 964503 979284 819760 911234 965862 828422 902985 960175 711430 798440 913146 938661)


# 24th  batch of seeds - 100
#seeds=(782695 814379 886722 956878 921572 879918 737853 979514 760175 918186 940380 795465 800453 833439 736413 878931 770662 985438 832389 712250 922552 877682 718174 891956 791047 939001 779238 873906 963408 842870 866705 920886 743985 814815 911171 810989 887959 776891 842653 940822 818116 967887 821230 804443 866021 942205 975299 823003 711662 953568 932041 847227 863164 943721 755565 780621 927568 798660 974888 867210 748540 763117 956413 929771 997850 943353 925267 874925 876213 802858 809981 812343 853346 900730 784518 966713 859007 940361 831863 729985 718634 890340 953466 731830 760874 724783 827600 941254 760350 936664 953923 726918 852770 859006 868227 951076 925391 819455 991819 834363)

#Jim 24 Dec 2024, extra seeds for failed jobs

#seeds=(401163 406478 416299 417284 423076 424641 429546 442727 446617 449613 450283 462076 486351 490942 503614 507673 508314 511200 516447 524896 532237 546917 550195 558708 558752 562006 563412 571307 583314 586144 591921 605930 )

#Jim 24 Dec 2024, extra seeds for failed jobs

seeds=(609305 614119 632054 634885 637929 647894 650136 652031 661443 662851 664328 666177 681507 692059 693647 694723 694890 695764 696182 698622 704690 712891 715461 715464 725914 727323 731247 731664 759591 763143 771965 780541 782851 787235 799634 803981 807098 816670 819260 821166 822762 824140 853140 853843 861262 872728 876974 884816 888340 888987 891043 896194 897189 900612 905822 914489 915985 917537 917798 917908 923972 929548 937325 938811 944295 953439 954776 971816 973335 986243)


# Get the seed for this task
SEED=${seeds[$SLURM_ARRAY_TASK_ID]}

#colliders=("C3_550_PS1" "C3_550_PS2")
#COLLIDER="C3_550_PS2"

for COLLIDER in "C3_550_PS1" "C3_550_PS2"; do
    #cd /fs/ddn/sdf/group/atlas/d/dntounis
    export HOME=/fs/ddn/sdf/group/atlas/d/dntounis

    # set up ATLAS environment: instrictuions from here: https://usatlas.readthedocs.io/projects/af-docs/en/latest/sshlogin/ssh2SLAC/

    export ATLAS_LOCAL_ROOT_BASE=/cvmfs/atlas.cern.ch/repo/ATLASLocalRootBase

    #export ALRB_CONT_RUNPAYLOAD="source /fs/ddn/sdf/group/atlas/d/dntounis/C^3/bkg_studies_2023/GuineaPig_July_2024/myJobPayload_ddsim_550_MERGE_slcio.sh $COLLIDER $SEED"
    export ALRB_CONT_RUNPAYLOAD="source /fs/ddn/sdf/group/atlas/d/dntounis/C^3/bkg_studies_2023/GuineaPig_July_2024/myJobPayload_ddsim_550_MERGE_edm4hep.sh $COLLIDER $SEED"

    #srun /fs/ddn/sdf/group/atlas/d/dntounis/C^3/bkg_studies_2023/GuineaPig_July_2024/myJobPayload_ddsim.sh $COLLIDER $SEED
    cd ~
    source $ATLAS_LOCAL_ROOT_BASE/user/atlasLocalSetup.sh -c el9 -b â€“pwd $PWD


done

